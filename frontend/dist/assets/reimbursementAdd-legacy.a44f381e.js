System.register(["./vendor-legacy.2803936c.js","./index-legacy.ec536723.js"],(function(e){"use strict";var t,n,r,u,l,a,i,o,s,c,d,m,f,_,p,g,b,v,F,y,h,S;return{setters:[function(e){t=e.e,n=e.aQ,r=e.aT,u=e.az,l=e.aU,a=e.j,i=e.B,o=e.r,s=e.c,c=e.m,d=e.f,m=e.g,f=e.t,_=e.s,p=e.i,g=e.F,b=e.v,v=e.q,F=e.E,y=e.Q},function(e){h=e._,S=e.b}],execute:function(){var z=t({name:"AdvanceForm",components:{Edit:n,DeleteFilled:r,Check:u,ArrowLeft:l},setup:function(){a();var e=i({reimbursement_id:0,user_id:0,amount:"",description:"",status:[],submitted_at:"",cc_user:[],notified_user:0}),t=o([]),n=o();return s((function(){S.getAllUsers().then((function(e){var n=e.data[0]||[];t.value=n.map((function(e){return{value:e.userId,label:e.username||e.email}}))})).catch((function(e){console.error("Failed to fetch users:",e),t.value=[]}))})),{sizeForm:e,all_users:t,activityForm:n,submitForm:function(){n.value.validate((function(t){if(t){var n=new Date,r=(a=(l=n).getFullYear(),i=String(l.getMonth()+1).padStart(2,"0"),o=String(l.getDate()).padStart(2,"0"),s=String(l.getHours()).padStart(2,"0"),c=String(l.getMinutes()).padStart(2,"0"),d=String(l.getSeconds()).padStart(2,"0"),"".concat(a,"-").concat(i,"-").concat(o," ").concat(s,":").concat(c,":").concat(d)),u={accessToken:sessionStorage.getItem("accessToken"),amount:e.amount,description:e.description,status:"未审核",submitted_at:r,review_user_id:e.notified_user,cc_user:e.cc_user};console.log("Submission form:",JSON.stringify(u));try{S.addReimbursement(u).then((function(t){e.reimbursement_id=t.data.reimbursement_id,console.log("Reimbursement ID:",e.reimbursement_id),e.cc_user&&e.cc_user.length>0&&e.cc_user.forEach((function(t){var r={notified_user_id:t,request_type:"reimbursement",request_id:e.reimbursement_id,submitted_at:n};S.addNotification(r).then((function(e){console.log("CC Notification added:",e.data)}))})),F({type:"success",message:"提交成功"})}))}catch(m){F({type:"warning",message:m.message})}return e.reimbursement_id=0,e.user_id=0,e.amount="",e.description="",e.status=[],e.submitted_at="",e.notified_user=0,e.cc_user=[],!0}var l,a,i,o,s,c,d;return console.log("submit error"),!1}))},resetForm:function(){n.value.resetFields()}}}}),V={class:"FormInfo"},k={class:"grid-content bg-purple-dark"},x={style:{"text-align":"left"}},w=p("span",null,"报销申请",-1),C=y("立即创建"),U=y("取消");e("default",h(z,[["render",function(e,t,n,r,u,l){var a=c("el-divider"),i=c("el-input"),o=c("el-form-item"),s=c("el-option"),F=c("el-select"),y=c("el-button"),h=c("el-form"),S=c("el-card"),z=c("el-col"),D=c("el-row");return d(),m("div",V,[f(D,null,{default:_((function(){return[f(z,{offset:1,span:22},{default:_((function(){return[p("div",k,[f(S,{class:"box-card"},{default:_((function(){return[p("div",x,[w,f(a)]),f(h,{ref:"activityForm",style:{"text-align":"left"},model:e.sizeForm,"label-width":"80px",size:"small"},{default:_((function(){return[f(o,{label:"金额"},{default:_((function(){return[f(i,{modelValue:e.sizeForm.amount,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.sizeForm.amount=t})},null,8,["modelValue"])]})),_:1}),f(o,{label:"内容"},{default:_((function(){return[f(i,{modelValue:e.sizeForm.description,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.sizeForm.description=t}),autosize:"",type:"textarea"},null,8,["modelValue"])]})),_:1}),f(o,{label:"报送"},{default:_((function(){return[f(F,{modelValue:e.sizeForm.notified_user,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.sizeForm.notified_user=t}),"collapse-tags":"",placeholder:"选择要报送的用户",style:{width:"240px"}},{default:_((function(){return[(d(!0),m(g,null,b(e.all_users,(function(e){return d(),v(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),f(o,{label:"抄送"},{default:_((function(){return[f(F,{modelValue:e.sizeForm.cc_user,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.sizeForm.cc_user=t}),"collapse-tags":"",placeholder:"选择要抄送的用户",style:{width:"240px"},multiple:""},{default:_((function(){return[(d(!0),m(g,null,b(e.all_users,(function(e){return d(),v(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),f(o,{size:"large"},{default:_((function(){return[f(y,{type:"primary",onClick:e.submitForm},{default:_((function(){return[C]})),_:1},8,["onClick"]),f(y,{onClick:e.resetForm},{default:_((function(){return[U]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model"])]})),_:1})])]})),_:1})]})),_:1})])}]]))}}}));
