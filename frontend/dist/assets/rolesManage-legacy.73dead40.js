!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,o,a=[],u=!0,l=!1;try{for(r=r.call(e);!(u=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);u=!0);}catch(i){l=!0,o=i}finally{try{u||null==r.return||r.return()}finally{if(l)throw o}}return a}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */a=function(){return t};var t={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},u=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",i=o.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(L){s=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),u=new R(n||[]);return a._invoke=function(e,t,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return D()}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var l=_(u,r);if(l){if(l===f)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var i=d(e,t,r);if("normal"===i.type){if(n=r.done?"completed":"suspendedYield",i.arg===f)continue;return{value:i.arg,done:r.done}}"throw"===i.type&&(n="completed",r.method="throw",r.arg=i.arg)}}}(e,r,u),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(L){return{type:"throw",arg:L}}}t.wrap=c;var f={};function p(){}function m(){}function h(){}var v={};s(v,u,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(S([])));y&&y!==r&&n.call(y,u)&&(v=y);var b=h.prototype=p.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function C(t,r){function o(a,u,l,i){var s=d(t[a],t,u);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==e(f)&&n.call(f,"__await")?r.resolve(f.__await).then((function(e){o("next",e,l,i)}),(function(e){o("throw",e,l,i)})):r.resolve(f).then((function(e){c.value=e,l(c)}),(function(e){return o("throw",e,l,i)}))}i(s.arg)}var a;this._invoke=function(e,t){function n(){return new r((function(r,n){o(e,t,r,n)}))}return a=a?a.then(n,n):n()}}function _(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=d(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function S(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:D}}function D(){return{value:void 0,done:!0}}return m.prototype=h,s(b,"constructor",h),s(h,"constructor",m),m.displayName=s(h,i,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,i,"GeneratorFunction")),e.prototype=Object.create(b),e},t.awrap=function(e){return{__await:e}},w(C.prototype),s(C.prototype,l,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var u=new C(c(e,r,n,o),a);return t.isGeneratorFunction(r)?u:u.next().then((function(e){return e.done?e.value:u.next()}))},w(b),s(b,i,"Generator"),s(b,u,(function(){return this})),s(b,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=S,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return u.type="throw",u.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),i=n.call(a,"finallyLoc");if(l&&i){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var u=a?a.completion:{};return u.type=e,u.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(u)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),k(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;k(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:S(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function u(e,t,r,n,o,a,u){try{var l=e[a](u),i=l.value}catch(s){return void r(s)}l.done?t(i):Promise.resolve(i).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function l(e){u(a,n,o,l,i,"next",e)}function i(e){u(a,n,o,l,i,"throw",e)}l(void 0)}))}}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f=document.createElement("style");f.innerHTML=".btns[data-v-08d50c7f]{text-align:right}.el-transfer[data-v-08d50c7f]{display:inline-block;text-align:left}.transfer[data-v-08d50c7f]{text-align:center}.card-header[data-v-08d50c7f]{text-align:left}.btns[data-v-1f3b31e9]{text-align:right}.el-transfer[data-v-1f3b31e9]{display:inline-block;text-align:left}.transfer[data-v-1f3b31e9]{text-align:center}.card-header[data-v-1f3b31e9]{text-align:left}.chart-widget-list p[data-v-2f268ce0]{border-bottom:1px solid #f1f3fa;margin-bottom:.5rem;padding-bottom:.5rem;display:flex;flex-direction:row;justify-content:space-between;align-items:center}.icon-square[data-v-2f268ce0]{width:12px;height:12px;display:inline-block}.red[data-v-2f268ce0]{background-color:#ec6769}.green[data-v-2f268ce0]{background-color:#93cb79}.yellow[data-v-2f268ce0]{background-color:#f9c761}.deep-blue[data-v-2f268ce0]{background-color:#5572c3}\n",document.head.appendChild(f),System.register(["./index-legacy.ec536723.js","./vendor-legacy.2803936c.js"],(function(e){"use strict";var n,o,u,s,d,f,p,m,h,v,g,y,b,w,C,_,x,k,R,S,D,L,P,I,O,j,E,T,N,A,V,U,z,q,F,K,M,B,G,H,Q,$,J,W,Y,X,Z;return{setters:[function(e){n=e._,o=e.r,u=e.u},function(e){s=e.e,d=e.R,f=e.B,p=e.k,m=e.D,h=e.m,v=e.aB,g=e.O,y=e.f,b=e.g,w=e.i,C=e.q,_=e.t,x=e.s,k=e.Q,R=e.y,S=e.C,D=e.S,L=e.F,P=e.v,I=e.p,O=e.h,j=e.r,E=e.c,T=e.aI,N=e.aJ,A=e.aK,V=e.aL,U=e.aM,z=e.aN,q=e.J,F=e.aq,K=e.n,M=e.aF,B=e.aO,G=e.aP,H=e.aQ,Q=e.aG,$=e.aH,J=e.ax,W=e.aR,Y=e.w,X=e.N,Z=e.E}],execute:function(){var ee=s({name:"RoleDetail",props:{currentRow:{type:Object,default:function(){return{userId:null,userName:"",userDepartment:"",userRole:"",userPhone:"",userAvatar:""}}}},setup:function(e){var t=d(e,"currentRow"),r=f({loading:!1,form:{userId:1,userName:"",userRole:"",userDepartment:"",userPhone:"",userEmail:"",userAvatar:""}}),n=[{value:"IT",label:"技术部"},{value:"Market",label:"市场部"},{value:"HR",label:"人力资源部"}],o=[{value:"admin",label:"管理员"},{value:"manager",label:"部门经理"},{value:"worker",label:"员工"}],a=p((function(){return t.value}));return c(c({},m(r)),{},{departments:n,roles:o,departmentLabel:function(e){var t=n.find((function(t){return t.value===e}));return t?t.label:"未知"},roleLabel:function(e){var t=o.find((function(t){return t.value===e}));return t?t.label:"未知"},row:a})}}),te={class:"new"},re={style:{display:"flex","justify-content":"center","align-items":"center"}},ne={key:1,style:{"text-align":"center"}};var oe=n(ee,[["render",function(e,t,r,n,o,a){var u=h("el-image"),l=h("el-descriptions-item"),i=h("el-descriptions"),s=v("loading");return g((y(),b("div",te,[w("div",re,[e.row.userAvatar?(y(),C(u,{key:0,style:{width:"100px",height:"100px","border-radius":"50%"},src:e.row.userAvatar,fit:"cover",referrerPolicy:"no-referrer"},null,8,["src"])):(y(),b("div",ne,"无头像"))]),_(i,{column:1,border:""},{default:x((function(){return[_(l,{label:"员工编号"},{default:x((function(){return[k(R(e.row.userId),1)]})),_:1}),_(l,{label:"名称"},{default:x((function(){return[k(R(e.row.userName),1)]})),_:1}),_(l,{label:"员工部门"},{default:x((function(){return[k(R(e.departmentLabel(e.row.userDepartment)),1)]})),_:1}),_(l,{label:"员工职位"},{default:x((function(){return[k(R(e.roleLabel(e.row.userRole)),1)]})),_:1}),_(l,{label:"邮箱"},{default:x((function(){return[k(R(e.row.userEmail),1)]})),_:1}),_(l,{label:"手机号码"},{default:x((function(){return[k(R(e.row.userPhone),1)]})),_:1})]})),_:1})])),[[s,e.loading]])}],["__scopeId","data-v-08d50c7f"]]),ae="http://127.0.0.1:8080/api",ue="/auth/permission/routes",le="/admin/user/list",ie="/admin/user/add",se="/admin/user/update",ce="/admin/user/delete",de="/admin/user/export",fe="/admin/user/download",pe="/admin/department/list",me=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"postAuthPermission",value:function(e){return o({url:ae+ue,method:"POST",json:!0,data:e}).then((function(e){return console.log(e),0===e.status?Promise.resolve(e):Promise.reject(e)}))}},{key:"postAdminQueryUserList",value:function(e){return o({url:ae+le,method:"POST",json:!0,data:e}).then((function(e){return 0===e.status?Promise.resolve(e):Promise.reject(e)}))}},{key:"postAdminAddUser",value:function(e){return o({url:ae+ie,method:"POST",json:!0,data:e}).then((function(e){return 0===e.status?Promise.resolve(e):Promise.reject(e)}))}},{key:"postAdminUpdateUser",value:function(e){return o({url:ae+se,method:"POST",json:!0,data:e}).then((function(e){return 0===e.status?Promise.resolve(e):Promise.reject(e)}))}},{key:"postAdminDeleteUser",value:function(e){return o({url:ae+ce,method:"POST",json:!0,data:e}).then((function(e){return 0===e.status?Promise.resolve(e):Promise.reject(e)}))}},{key:"postAdminExportUser",value:function(e){return o({url:ae+de,method:"POST",responseType:"blob",json:!0,data:e}).then((function(e){if(e)if(e instanceof Blob){var t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.setAttribute("download","用户列表_"+(new Date).getTime()+".xls"),document.body.appendChild(r),r.click(),document.body.removeChild(r)}else console.error("响应数据不是 Blob 类型")})).catch((function(e){throw console.error("Error downloading excel:",e),e}))}},{key:"postAdminPrintUser",value:function(e){return o({url:ae+fe,method:"POST",responseType:"blob",json:!0,data:e}).then((function(e){if(e)if(e instanceof Blob){var t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.setAttribute("download","用户列表_"+(new Date).getTime()+".pdf"),document.body.appendChild(r),r.click(),document.body.removeChild(r)}else console.error("响应数据不是 Blob 类型")})).catch((function(e){throw console.error("Error downloading pdf:",e),e}))}},{key:"postAdminQueryDepartmentList",value:function(e){return o({url:ae+pe,method:"POST",json:!0,data:e}).then((function(e){return 0===e.status?Promise.resolve(e):Promise.reject(e)}))}}],(r=null)&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),he=s({name:"RolesEdit",props:{currentRow:{type:Object,default:function(){return{userName:"",userDepartment:"",userRole:""}}}},emits:["success"],setup:function(e,t){var r=t.emit,n=d(e,"currentRow"),o=u(),i=p((function(){return o.getters["settingsModule/getLangState"]})),s=f({url:"/role/allow",purl:"/role/permissions",loading:!1,form:{userName:"",userRole:"",userDepartment:""},menu:{loading:!1,url:"/menu/list",data:[],form:[]}}),h=p((function(){return n.value})),v=function(){var e=l(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("form is ",s.menu.form),t={accessToken:sessionStorage.getItem("accessToken"),userName:s.form.userName,userDepartment:s.form.userDepartment,userRole:s.form.userRole,userId:h.value.userId},e.next=4,me.postAdminUpdateUser(t);case 4:0===e.sent.status&&r("success");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return S((function(){h.value&&(s.form.userName=h.value.userName,s.form.userRole=h.value.userRole,s.form.userDepartment=h.value.userDepartment)})),c(c({},m(s)),{},{rules:{userId:[{required:!0,message:"请输入员工ID",trigger:"blur"},{type:"number",message:"请输入有效数字",trigger:"blur"}],userDepartment:[{required:!0,message:"请选择部门",trigger:"change"}],userRole:[{required:!0,message:"请输入员工职能",trigger:"change"}]},departments:[{value:"IT",label:"技术部"},{value:"Market",label:"市场部"},{value:"HR",label:"人力资源部"}],roles:[{value:"admin",label:"管理员"},{value:"manager",label:"部门经理"},{value:"worker",label:"员工"}],lang:i,row:h,saveData:v})}}),ve={class:"new"},ge={key:0},ye=function(e){return I("data-v-1f3b31e9"),e=e(),O(),e}((function(){return w("i",{class:"fa fa-plus"},null,-1)})),be=k(" 修改 ");var we=n(he,[["render",function(e,t,r,n,o,a){var u=h("el-form-item"),l=h("el-option"),i=h("el-select"),s=h("el-button"),c=h("el-row"),d=h("el-form"),f=v("loading");return g((y(),b("div",ve,[_(d,{ref:"formRef",model:e.form,rules:e.rules,"label-position":"right","label-width":"100px",title:"新增员工"},{default:x((function(){return[_(u,{label:"名称"},{default:x((function(){return[e.row&&e.row.userName?(y(),b("span",ge,R(e.row.userName),1)):D("",!0)]})),_:1}),_(u,{label:"员工部门",prop:"userDepartment"},{default:x((function(){return[_(i,{modelValue:e.form.userDepartment,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.form.userDepartment=t}),placeholder:"请选择部门"},{default:x((function(){return[(y(!0),b(L,null,P(e.departments,(function(e){return y(),C(l,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),_(u,{label:"员工职位",prop:"userRole"},{default:x((function(){return[_(i,{modelValue:e.form.userRole,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.form.userRole=t}),placeholder:"请选择职能"},{default:x((function(){return[(y(!0),b(L,null,P(e.roles,(function(e){return y(),C(l,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),_(c,{class:"btn-container"},{default:x((function(){return[_(s,{size:"mini",type:"primary",onClick:t[2]||(t[2]=function(t){return e.saveData()})},{default:x((function(){return[ye,be]})),_:1})]})),_:1})]})),_:1},8,["model","rules"])])),[[f,e.loading]])}],["__scopeId","data-v-1f3b31e9"]]),Ce=s({name:"RoleNew",emits:["success"],setup:function(e,t){var r=t.emit,n=[{value:"1",label:"HR"}],o=j(),u=f({form:{userName:"",departmentId:null,userRole:""},loading:!1}),i=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.value.validate(function(){var e=l(a().mark((function e(t){var o,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return l={accessToken:sessionStorage.getItem("accessToken"),userName:u.form.userName,userDepartment:null===(o=n.find((function(e){return e.value===u.form.departmentId})))||void 0===o?void 0:o.label,userRole:u.form.userRole,departmentId:u.form.departmentId},e.next=4,me.postAdminAddUser(l);case 4:0===e.sent.status&&r("success");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=l(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.postAdminQueryDepartmentList({accessToken:sessionStorage.getItem("accessToken")});case 2:if(0===(t=e.sent).status)for(n.splice(0,n.length),r=0;r<t.data.length;r++)n.push({value:t.data[r].departmentId,label:t.data[r].departmentName});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return E((function(){s()})),c({submitForm:i,getDepartments:s,rules:{userName:[{required:!0,message:"请输入员工名",trigger:"blur"}],departmentId:[{required:!0,message:"请选择部门",trigger:"change"}],userRole:[{required:!0,message:"请输入员工职能",trigger:"change"}]},departments:n,roles:[{value:"admin",label:"管理员"},{value:"manager",label:"部门经理"},{value:"worker",label:"员工"}],formRef:o,url:"/role/add"},m(u))}}),_e={class:"new"},xe=w("i",{class:"fa fa-plus"},null,-1),ke=k(" 新增 ");var Re,Se=n(Ce,[["render",function(e,t,r,n,o,a){var u=h("el-input"),l=h("el-form-item"),i=h("el-option"),s=h("el-select"),c=h("el-button"),d=h("el-row"),f=h("el-form"),p=v("loading");return g((y(),b("div",_e,[_(f,{ref:"formRef",model:e.form,rules:e.rules,"label-position":"right","label-width":"100px",title:"新增员工"},{default:x((function(){return[_(l,{label:"员工名",prop:"userName"},{default:x((function(){return[_(u,{modelValue:e.form.userName,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.form.userName=t}),placeholder:"请输入员工名"},null,8,["modelValue"])]})),_:1}),_(l,{label:"员工部门",prop:"userDepartment"},{default:x((function(){return[_(s,{modelValue:e.form.departmentId,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.form.departmentId=t}),placeholder:"请选择部门"},{default:x((function(){return[(y(!0),b(L,null,P(e.departments,(function(e){return y(),C(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),_(l,{label:"员工职位",prop:"userRole"},{default:x((function(){return[_(s,{modelValue:e.form.userRole,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.form.userRole=t}),placeholder:"请选择职能"},{default:x((function(){return[(y(!0),b(L,null,P(e.roles,(function(e){return y(),C(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),_(d,{class:"btn-container"},{default:x((function(){return[_(c,{size:"mini",type:"primary",onClick:t[3]||(t[3]=function(t){return e.submitForm()})},{default:x((function(){return[xe,ke]})),_:1})]})),_:1})]})),_:1},8,["model","rules"])])),[[p,e.loading]])}]]);T([N,A,V,U,z]);var De=function(e,t){var r=q(e);(Re={tooltip:{trigger:"item"},legend:{top:"2%",left:"center"},series:[{type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"20",fontWeight:"bold"}},labelLine:{show:!1},data:t}]})&&r.setOption(Re)},Le=s({name:"RoleStatistic",props:{data:{type:Array,default:function(){return[]}}},setup:function(e){var t=j(null),n=j(null),o=f({data:e.data||[],rolesCount:{},departmentsCount:{}}),a={admin:"管理员",manager:"部门经理",worker:"员工"},u={"管理员":"icon-square red","部门经理":"icon-square green","员工":"icon-square deep-blue"},l={IT:"技术部",HR:"人力资源部",Market:"市场部"},i={"技术部":"icon-square red","人力资源部":"icon-square green","市场部":"icon-square deep-blue"},s=o.data.length,d=function(){o.data.forEach((function(e){var t=a[e.userRole]||e.userRole;t&&(o.rolesCount[t]?o.rolesCount[t]++:o.rolesCount[t]=1)})),o.data.forEach((function(e){var t=l[e.userDepartment]||e.userDepartment;t&&(o.departmentsCount[t]?o.departmentsCount[t]++:o.departmentsCount[t]=1)}))},p=function(){var e=Object.entries(o.rolesCount).map((function(e){var t=r(e,2);return{name:t[0],value:t[1]}})),a=Object.entries(o.departmentsCount).map((function(e){var t=r(e,2);return{name:t[0],value:t[1]}}));F((function(){t.value?De(t.value,e):console.log("refRolesChart not exist!"),n.value?De(n.value,a):console.log("refDepartmentsChart not exist!")}))};return E((function(){d(),p()})),c(c({},m(o)),{},{getRoleIconClass:function(e){return u[e]||"icon-square"},getDepartmentIconClass:function(e){return i[e]||"icon-square"},displayChart:p,doStatistics:d,roleMapping:a,roleIconMapping:u,departmentMapping:l,departmentIconMapping:i,refDepartmentsChart:n,refRolesChart:t,totalPeople:s})}}),Pe=function(e){return I("data-v-2f268ce0"),e=e(),O(),e},Ie=Pe((function(){return w("span",null,[w("i",{class:"icon-square red"}),k(" 总人数")],-1)})),Oe=k(),je={class:"role"},Ee=Pe((function(){return w("h3",null,"按角色统计",-1)})),Te={class:"e-chart",style:{height:"201px",width:"100%"}},Ne={ref:"refRolesChart",style:{width:"inherit",height:"inherit"}},Ae={class:"chart-widget-list"},Ve={class:"department"},Ue=Pe((function(){return w("h3",null,"按部门统计",-1)})),ze={class:"e-chart",style:{height:"201px",width:"100%"}},qe={ref:"refDepartmentsChart",style:{width:"inherit",height:"inherit"}},Fe={class:"chart-widget-list"};var Ke=s({name:"RoleManage",components:{InfoFilled:M,Printer:B,Download:G,RoleDetail:oe,RoleEdit:we,RoleNew:Se,RoleStatistic:n(Le,[["render",function(e,t,r,n,o,a){var u=h("el-card");return y(),b("div",null,[_(u,{shadow:"hover",class:"card"},{default:x((function(){return[w("p",null,[Ie,Oe,w("span",null,R(e.totalPeople),1)]),w("div",je,[Ee,w("div",Te,[w("div",Ne,null,512)]),w("div",Ae,[(y(!0),b(L,null,P(e.rolesCount,(function(t,r){return y(),b("p",{key:r},[w("span",null,[w("i",{class:K(e.getRoleIconClass(r))},null,2),k(" "+R(r),1)]),w("span",null,R(t),1)])})),128))])]),w("div",Ve,[Ue,w("div",ze,[w("div",qe,null,512)]),w("div",Fe,[(y(!0),b(L,null,P(e.departmentsCount,(function(t,r){return y(),b("p",{key:r},[w("span",null,[w("i",{class:K(e.getDepartmentIconClass(r))},null,2),k(" "+R(r),1)]),w("span",null,R(t),1)])})),128))])])]})),_:1})])}],["__scopeId","data-v-2f268ce0"]]),Edit:H,Minus:Q,Plus:$,Refresh:J,Odometer:W},setup:function(){var e=f({url:{c:"/role/add",r:"/role/list",u:"/role/update",d:"/role/delete"},param:{total:0,size:10,page:1},data:[],filteredData:[],loading:!1,is_search:!1,add_visible:!1,edit_visible:!1,detail_visible:!1,statistic_visible:!1,posted:{userRow:{userId:null,userName:"",userRole:"",userDepartment:"",userEmail:"",userPhone:"",userAvatar:""}},sortField:"",sortOrder:"",userIds:[],selectionRows:[],searchKeyword:""}),r=function(){return e.sortField?t(e.data).sort((function(t,r){var n=t[e.sortField],o=r[e.sortField];return n<o?"asc"===e.sortOrder?-1:1:n>o?"asc"===e.sortOrder?1:-1:0})):e.data},n=function(){var t=l(a().mark((function t(){var r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.is_search=!1,r={accessToken:sessionStorage.getItem("accessToken")},t.next=4,me.postAdminQueryUserList(r);case 4:0===(n=t.sent).status&&(e.data=n.data,e.userIds=n.data.map((function(e){return e.userId})),e.param.total=e.data.length);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),o=function(){return e.is_search?r().filter((function(t){return t.userName.toLowerCase().includes(e.searchKeyword.toLowerCase())||t.userRole.toLowerCase().includes(e.searchKeyword.toLowerCase())||t.userDepartment.toLowerCase().includes(e.searchKeyword.toLowerCase())||t.userPhone.toLowerCase().includes(e.searchKeyword.toLowerCase())})).slice((e.param.page-1)*e.param.size,e.param.page*e.param.size):r().slice((e.param.page-1)*e.param.size,e.param.page*e.param.size)},u=function(){""!=e.searchKeyword?(e.is_search=!0,e.param.page=1,e.filteredData=e.data.filter((function(t){return t.userName.toLowerCase().includes(e.searchKeyword.toLowerCase())||t.userRole.toLowerCase().includes(e.searchKeyword.toLowerCase())||t.userDepartment.toLowerCase().includes(e.searchKeyword.toLowerCase())||t.userPhone.toLowerCase().includes(e.searchKeyword.toLowerCase())})),e.param.total=e.filteredData.length):(e.is_search=!1,e.param.page=1,e.param.total=e.data.length)},i=function(){var e=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:X.confirm("此操作将删除该员工所有数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(l(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={userId:t.userId,accessToken:sessionStorage.getItem("accessToken")},e.next=3,me.postAdminDeleteUser(r);case 3:0===e.sent.status?(Z({type:"success",message:"删除成功"}),n()):Z({type:"error",message:"删除失败"});case 5:case"end":return e.stop()}}),e)})))).catch((function(){Z({type:"info",message:"已取消删除"})}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(){var t=l(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:X.confirm("确定要导出为Excel吗","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(l(a().mark((function t(){var r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.selectionRows.length>0?e.selectionRows:e.userIds,n={accessToken:sessionStorage.getItem("accessToken"),user_ids:r},me.postAdminExportUser(n).then((function(){Z({type:"success",message:"Excel 文件正在下载..."})})).catch((function(){Z({type:"error",message:"下载失败，请重试"})}));case 3:case"end":return t.stop()}}),t)})))).catch((function(){Z({type:"info",message:"已取消"})}));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=function(){var t=l(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:X.confirm("确定要下载PDF吗","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(l(a().mark((function t(){var r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.selectionRows.length>0?e.selectionRows:e.userIds,n={accessToken:sessionStorage.getItem("accessToken"),user_ids:r},me.postAdminPrintUser(n).then((function(){Z({type:"success",message:"PDF 文件正在下载..."})})).catch((function(){Z({type:"error",message:"下载失败，请重试"})}));case 3:case"end":return t.stop()}}),t)})))).catch((function(){Z({type:"info",message:"已取消"})}));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),p=function(){var t=l(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.statistic_visible=!0;case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Y((function(){return e.searchKeyword}),(function(e){u()})),E((function(){n(),o()})),c(c({},m(e)),{},{displayData:o,handleSelectionChange:function(t){e.selectionRows=t.map((function(e){return e.userId})),console.log("SelectionRows",e.selectionRows)},onCurrentChange:function(t){e.param.page=t},onSizeChange:function(t){e.param.page=1,e.param.size=t},onCreate:function(){e.add_visible=!0},onCreateSuccess:function(t){e.add_visible=!1,n()},onEditSuccess:function(){e.edit_visible=!1,n()},onDetail:function(t,r){console.log("row",r),e.posted.userRow.userId=r.userId,e.posted.userRow.userName=r.userName,e.posted.userRow.userRole=r.userRole,e.posted.userRow.userDepartment=r.userDepartment,e.posted.userRow.userEmail=r.userEmail,e.posted.userRow.userPhone=r.userPhone,e.posted.userRow.userAvatar=r.userAvatar,e.detail_visible=!0},onEdit:function(t,r){console.log("row",r),e.posted.userRow.userId=r.userId,e.posted.userRow.userName=r.userName,e.posted.userRow.userRole=r.userRole,e.posted.userRow.userDepartment=r.userDepartment,e.edit_visible=!0},onDelete:function(e,t){console.log(e,t),i(t)},onSearch:u,onExport:s,onPrint:d,onStatistic:p,fetchData:n,handleSortChange:function(t){var r=t.prop,n=t.order;e.sortField=r,e.sortOrder="ascending"===n?"asc":"desc"}})}}),Me=k("新增用户"),Be=k("导出列表"),Ge=k("打印列表"),He=k("统计信息"),Qe=w("br",null,null,-1),$e={class:"pagination"};e("default",n(Ke,[["render",function(e,t,r,n,o,a){var u=h("plus"),l=h("el-icon"),i=h("el-button"),s=h("download"),c=h("printer"),d=h("odometer"),f=h("el-col"),p=h("el-input"),m=h("el-row"),k=h("el-table-column"),R=h("InfoFilled"),S=h("el-tooltip"),D=h("edit"),L=h("minus"),P=h("el-table"),I=h("el-pagination"),O=h("el-card"),j=h("role-detail"),E=h("el-dialog"),T=h("role-statistic"),N=h("role-edit"),A=h("role-new"),V=v("loading");return y(),b("div",null,[_(O,{class:"card-ctrl"},{default:x((function(){return[_(m,null,{default:x((function(){return[_(f,{span:10,style:{"text-align":"left"}},{default:x((function(){return[_(i,{type:"primary",size:"medium",onClick:e.onCreate},{default:x((function(){return[_(l,null,{default:x((function(){return[_(u)]})),_:1}),Me]})),_:1},8,["onClick"]),_(i,{type:"info",size:"medium",onClick:e.onExport},{default:x((function(){return[_(l,null,{default:x((function(){return[_(s)]})),_:1}),Be]})),_:1},8,["onClick"]),_(i,{type:"info",size:"medium",onClick:e.onPrint},{default:x((function(){return[_(l,null,{default:x((function(){return[_(c)]})),_:1}),Ge]})),_:1},8,["onClick"]),_(i,{type:"success",size:"medium",onClick:e.onStatistic},{default:x((function(){return[_(l,null,{default:x((function(){return[_(d)]})),_:1}),He]})),_:1},8,["onClick"])]})),_:1}),_(f,{span:14,style:{"text-align":"right"}},{default:x((function(){return[_(p,{modelValue:e.searchKeyword,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchKeyword=t}),placeholder:"请输入关键词",style:{width:"200px","margin-right":"10px"}},null,8,["modelValue"])]})),_:1})]})),_:1}),Qe,g((y(),C(P,{data:e.displayData(),stripe:"",class:"table",onSelectionChange:e.handleSelectionChange},{default:x((function(){return[_(k,{type:"selection",width:"55",align:"center",sortable:"",onSortChange:e.handleSortChange},null,8,["onSortChange"]),_(k,{prop:"userId",label:"用户ID",align:"center",sortable:"",onSortChange:e.handleSortChange},null,8,["onSortChange"]),_(k,{prop:"userName",label:"用户名",align:"center",sortable:"",onSortChange:e.handleSortChange},null,8,["onSortChange"]),_(k,{prop:"userDepartment",label:"部门",align:"center",sortable:"",onSortChange:e.handleSortChange},null,8,["onSortChange"]),_(k,{prop:"userRole",label:"职位",align:"center",sortable:"",onSortChange:e.handleSortChange},null,8,["onSortChange"]),_(k,{prop:"userPhone",label:"电话号码",align:"center",sortable:"",onSortChange:e.handleSortChange},null,8,["onSortChange"]),_(k,{label:"操作",align:"center"},{default:x((function(t){return[_(S,{class:"item",effect:"dark",content:"详情",placement:"bottom"},{default:x((function(){return[_(i,{circle:"",plain:"",type:"info",size:"small",onClick:function(r){return e.onDetail(t.$index,t.row)}},{default:x((function(){return[_(l,null,{default:x((function(){return[_(R)]})),_:1})]})),_:2},1032,["onClick"])]})),_:2},1024),_(S,{class:"item",effect:"dark",content:"修改",placement:"bottom"},{default:x((function(){return[_(i,{circle:"",plain:"",type:"primary",size:"small",onClick:function(r){return e.onEdit(t.$index,t.row)}},{default:x((function(){return[_(l,null,{default:x((function(){return[_(D)]})),_:1})]})),_:2},1032,["onClick"])]})),_:2},1024),_(S,{class:"item",effect:"dark",content:"删除",placement:"bottom"},{default:x((function(){return[_(i,{circle:"",plain:"",type:"danger",size:"small",onClick:function(r){return e.onDelete(t.$index,t.row)}},{default:x((function(){return[_(l,null,{default:x((function(){return[_(L)]})),_:1})]})),_:2},1032,["onClick"])]})),_:2},1024)]})),_:1})]})),_:1},8,["data","onSelectionChange"])),[[V,e.loading]]),w("div",$e,[_(I,{"current-page":e.param.page,"page-size":e.param.size,layout:"sizes,prev,pager,next,total","page-sizes":[10,20,50],total:e.param.total,background:"",onCurrentChange:e.onCurrentChange,onSizeChange:e.onSizeChange},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])])]})),_:1}),_(E,{modelValue:e.detail_visible,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.detail_visible=t}),center:"",title:"员工信息详情"},{default:x((function(){return[_(j,{"current-row":e.posted.userRow},null,8,["current-row"])]})),_:1},8,["modelValue"]),_(E,{modelValue:e.statistic_visible,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.statistic_visible=t}),center:"",title:"统计信息"},{default:x((function(){return[_(T,{data:e.data},null,8,["data"])]})),_:1},8,["modelValue"]),_(E,{modelValue:e.edit_visible,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.edit_visible=t}),center:"",title:e.posted.userRow.userRole},{default:x((function(){return[_(N,{"current-row":e.posted.userRow,onSuccess:e.onEditSuccess},null,8,["current-row","onSuccess"])]})),_:1},8,["modelValue","title"]),_(E,{modelValue:e.add_visible,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.add_visible=t}),title:"新增员工"},{default:x((function(){return[_(A,{onSuccess:e.onCreateSuccess},null,8,["onSuccess"])]})),_:1},8,["modelValue"])])}]]))}}}))}();
